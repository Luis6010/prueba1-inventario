<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protege Bien</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const App = () => {
            const [inventario, setInventario] = useState(() => {
                const d = localStorage.getItem('pb_data');
                return d ? JSON.parse(d) : [];
            });
            const [cat, setCat] = useState("General");
            const [open, setOpen] = useState(false);
            const [modal, setModal] = useState(false);
            const [nuevo, setNuevo] = useState({ idE: '', nom: '', ok: 0, bj: 0, cat: 'Laptops' });

            const depts = {
                "Tecnolog√≠a (TI)": ['Laptops', 'CPU', 'Celulares', 'Monitores', 'Teclados', 'Mouse', 'Cables', 'Impresoras', 'Telefonos', 'Mousepad', 'Extension', 'Cargadores', 'Adaptadores', 'Escaneres', 'Soporte Laptop', 'Soporte Pantalla', 'Pantalla', 'Repetidores', 'Preamplificadores', 'Switch', 'Alexa', 'Fuente Alimentacion', 'Memoria USB', 'Router', 'Camara', 'Disco', 'Trituradora', 'Convertidor', 'Transmisor', 'Control'],
                "Direccion": ['Paquetes Alcanfores', 'Paquetes Cerveza', 'Paquetes Para Tasas', 'Vinos', 'Tasas', 'Listones']
            };

            useEffect(() => { localStorage.setItem('pb_data', JSON.stringify(inventario)); }, [inventario]);

            const filtrados = inventario.filter(i => cat === "General" || i.cat === cat);

            return (
                <div className="flex h-screen font-sans text-slate-800">
                    {/* Sidebar */}
                    <aside className={`${open ? 'translate-x-0' : '-translate-x-full'} fixed inset-y-0 left-0 z-50 w-64 bg-[#002d5b] text-white transition-transform lg:relative lg:translate-x-0`}>
                        <div className="p-6 border-b border-white/10 italic font-black text-[#4a90e2] text-xl">PROTEGE BIEN</div>
                        <nav className="p-4 overflow-y-auto h-full pb-20">
                            <button onClick={() => {setCat("General"); setOpen(false);}} className="w-full text-left p-3 hover:bg-white/10 rounded-lg font-bold text-sm mb-4">üìä PANEL GENERAL</button>
                            {Object.entries(depts).map(([d, items]) => (
                                <div key={d} className="mb-4">
                                    <p className="text-[10px] text-[#4a90e2] font-black uppercase px-3 mb-2">{d}</p>
                                    {items.map(i => (
                                        <button key={i} onClick={() => {setCat(i); setOpen(false);}} className={`w-full text-left py-1.5 px-6 text-xs ${cat === i ? 'text-white font-bold' : 'text-slate-400'}`}>{i}</button>
                                    ))}
                                </div>
                            ))}
                        </nav>
                    </aside>

                    {/* Contenido */}
                    <main className="flex-1 flex flex-col min-w-0">
                        <header className="p-4 bg-white border-b flex justify-between items-center">
                            <button onClick={() => setOpen(true)} className="lg:hidden">‚ò∞</button>
                            <h1 className="font-black uppercase italic text-sm truncate px-4">{cat}</h1>
                            <button onClick={() => setModal(true)} className="bg-[#002d5b] text-white px-4 py-2 rounded-lg font-black text-[10px]">+ NUEVO</button>
                        </header>

                        <div className="p-4 overflow-y-auto space-y-3">
                            {filtrados.map(i => (
                                <div key={i.id} className="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                                    <div className="flex justify-between text-[9px] font-bold text-blue-500 mb-1">
                                        <span>ID: {i.idE}</span>
                                        <button onClick={() => setInventario(prev => prev.filter(x => x.id !== i.id))}>üóëÔ∏è</button>
                                    </div>
                                    <p className="font-black italic uppercase text-sm">{i.nom}</p>
                                    <div className="flex gap-4 mt-2 text-center font-black">
                                        <div className="flex-1 bg-slate-100 p-2 rounded-lg text-xs">Total: {Number(i.ok)+Number(i.bj)}</div>
                                        <div className="flex-1 bg-blue-50 text-blue-600 p-2 rounded-lg text-xs">OK: {i.ok}</div>
                                        <div className="flex-1 bg-red-50 text-red-600 p-2 rounded-lg text-xs">Baja: {i.bj}</div>
                                    </div>
                                </div>
                            ))}
                        </div>

                        {modal && (
                            <div className="fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 text-sm">
                                <div className="bg-white rounded-2xl p-6 w-full max-w-sm">
                                    <h2 className="font-black mb-4 uppercase italic">Nuevo Registro</h2>
                                    <input className="w-full p-3 bg-slate-100 rounded-xl mb-2" placeholder="ID Etiqueta" onChange={e => setNuevo({...nuevo, idE: e.target.value})} />
                                    <input className="w-full p-3 bg-slate-100 rounded-xl mb-2" placeholder="Nombre / Marca" onChange={e => setNuevo({...nuevo, nom: e.target.value})} />
                                    <select className="w-full p-3 bg-slate-100 rounded-xl mb-4" onChange={e => setNuevo({...nuevo, cat: e.target.value})}>
                                        {Object.values(depts).flat().map(x => <option key={x} value={x}>{x}</option>)}
                                    </select>
                                    <div className="flex gap-2 mb-4">
                                        <input type="number" className="w-1/2 p-3 bg-blue-50 rounded-xl text-center font-bold" placeholder="OK" onChange={e => setNuevo({...nuevo, ok: e.target.value})} />
                                        <input type="number" className="w-1/2 p-3 bg-red-50 rounded-xl text-center font-bold" placeholder="Baja" onChange={e => setNuevo({...nuevo, bj: e.target.value})} />
                                    </div>
                                    <div className="flex gap-2 font-black uppercase text-[10px]">
                                        <button onClick={() => setModal(false)} className="flex-1 p-4">Cerrar</button>
                                        <button onClick={() => {
                                            setInventario([...inventario, {...nuevo, id: Date.now()}]);
                                            setModal(false);
                                        }} className="flex-1 p-4 bg-[#002d5b] text-white rounded-xl shadow-lg">Guardar</button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
